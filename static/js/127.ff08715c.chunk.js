"use strict";(self.webpackChunklabs_helper=self.webpackChunklabs_helper||[]).push([[127],{127:(e,t,s)=>{s.r(t),s.d(t,{default:()=>m});var r=s(950),l=s(673),a=s(818),i=s(235),d=s(501),n=s(652),c=s(192),o=s(832),x=s(414);const m=(0,l.PA)(e=>{var t,s;let{dialog:l,model:m}=e;(0,a.v)(m);const[h,p]=(0,r.useState)(null),[b,u]=(0,r.useState)(null),y=(0,r.useRef)(new Map),g=(0,r.useRef)(new Map);(0,r.useEffect)(()=>{g.current.forEach((e,t)=>{b===t&&e?(e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.width="95vw",e.style.height="calc(95vh - 2rem)",e.style.zIndex="200",e.style.opacity="1",e.style.pointerEvents="auto"):e&&(e.style.position="",e.style.top="",e.style.left="",e.style.transform="",e.style.width="",e.style.height="",e.style.zIndex="",e.style.opacity="",e.style.pointerEvents="")})},[b]);return m.exam&&m.attempt?(0,x.jsxs)(i.aF,{onOverlayClick:e=>{e.target===e.currentTarget&&m.cancel()},size:"large",children:[(0,x.jsx)(i.rQ,{children:(0,x.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,x.jsxs)("h3",{className:"m-0 text-xl font-semibold text-text-primary",children:["\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b: ",(null===(t=m.attempt.user)||void 0===t?void 0:t.fullName)||"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e"]}),(0,x.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,x.jsx)(d.A,{variant:m.attempt.status,size:"sm",children:(0,c.F)(m.attempt.status)}),(0,x.jsxs)("div",{className:"text-lg font-semibold text-accent-blue",children:["\u0411\u0430\u043b\u043b\u044b: ",m.getTotalScore()," / ",m.getMaxScore()]})]})]})}),(0,x.jsx)(i.cw,{children:(0,x.jsxs)("div",{className:"min-h-[400px]",children:[(0,x.jsx)("div",{className:"mb-6 p-4 bg-bg-secondary rounded-lg border border-border",children:(0,x.jsxs)("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-1",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{className:"text-text-secondary text-sm",children:"\u0421\u0442\u0443\u0434\u0435\u043d\u0442:"}),(0,x.jsx)("p",{className:"text-text-primary",children:(null===(s=m.attempt.user)||void 0===s?void 0:s.fullName)||"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{className:"text-text-secondary text-sm",children:"\u041d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u044f:"}),(0,x.jsx)("p",{className:"text-text-primary",children:(e=>{if(!e||!Array.isArray(e)||0===e.length)return"\u041d\u0435\u0442 \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u0439";const t=e.reduce((e,t)=>e+(t.durationMs||0),0),s=Math.floor(t/6e4),r=Math.floor(t%6e4/1e3);return"".concat(e.length," \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u0439, \u0432\u0441\u0435\u0433\u043e ").concat(s,"\u043c ").concat(r,"\u0441 \u0432\u043d\u0435 \u0444\u043e\u043a\u0443\u0441\u0430")})(m.attempt.violations)})]})]})}),m.exam.questions&&(0,x.jsx)("div",{className:"flex flex-col gap-6",children:m.exam.questions.map((e,t)=>{const s=String(e.id),r=m.attempt.answers[s],l=m.questionGrades[s],a=m.getQuestionMaxPoints(e.id),i="multiple_choice"===e.type&&e.correctAnswer;return(0,x.jsxs)("div",{className:"p-4 lg:p-6 bg-bg-secondary rounded-lg border border-border",children:[(0,x.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,x.jsxs)("h5",{className:"m-0 flex-1 text-text-primary",children:["\u0412\u043e\u043f\u0440\u043e\u0441 ",t+1,": ",e.question]}),(0,x.jsxs)("span",{className:"px-3 py-1 bg-accent-blue text-white rounded text-sm font-semibold ml-4",children:["\u041c\u0430\u043a\u0441. \u0431\u0430\u043b\u043b\u043e\u0432: ",a]})]}),"multiple_choice"===e.type&&e.options&&(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("strong",{className:"block mb-2 text-text-primary",children:"\u0412\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u043e\u0442\u0432\u0435\u0442\u0430:"}),(0,x.jsx)("ul",{className:"list-disc list-inside space-y-1 text-text-primary",children:e.options.map((e,t)=>(0,x.jsx)("li",{className:r===e?"font-semibold text-accent-blue":"text-text-secondary",children:e},t))}),(0,x.jsxs)("p",{className:"mt-2 text-text-primary",children:[(0,x.jsx)("strong",{children:"\u041e\u0442\u0432\u0435\u0442 \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u0430:"})," ",r||"\u041d\u0435\u0442 \u043e\u0442\u0432\u0435\u0442\u0430"]})]}),"text"===e.type&&(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("strong",{className:"block mb-2 text-text-primary",children:"\u041e\u0442\u0432\u0435\u0442 \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u0430:"}),r?(0,x.jsx)("div",{className:"p-4 bg-bg-primary rounded-md border border-border",children:(0,x.jsx)("p",{className:"text-text-primary whitespace-pre-wrap",children:r})}):(0,x.jsx)("div",{className:"text-text-secondary",children:"\u041d\u0435\u0442 \u043e\u0442\u0432\u0435\u0442\u0430"})]}),"code"===e.type&&(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("strong",{className:"block mb-2 text-text-primary",children:"\u041e\u0442\u0432\u0435\u0442 \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u0430:"}),(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{className:"relative border border-border rounded-md overflow-hidden",ref:t=>{t?y.current.set(e.id,t):y.current.delete(e.id)},children:[b!==e.id&&(0,x.jsx)("div",{className:"absolute top-2 right-2 z-10",children:(0,x.jsx)("button",{onClick:()=>u(e.id),className:"px-3 py-1.5 bg-bg-primary border border-border rounded-md text-text-primary text-sm font-semibold hover:bg-border transition-colors shadow-lg",title:"\u0420\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u043f\u0435\u0441\u043e\u0447\u043d\u0438\u0446\u0443",children:"\u26f6 \u0420\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c"})}),(0,x.jsx)("iframe",{ref:t=>{t?g.current.set(e.id,t):g.current.delete(e.id)},src:"https://sharplab.io/",className:"w-full h-[400px] border-0 transition-all",title:"Sharplab.io sandbox"})]}),r?(0,x.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,x.jsx)("div",{className:"flex justify-end",children:(0,x.jsxs)(n.A,{variant:"secondary",size:"md",onClick:()=>(async(e,t)=>{try{await navigator.clipboard.writeText(e),p(t),setTimeout(()=>p(null),2e3)}catch(s){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f:",s)}})(r,e.id),title:"\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u0434",className:"flex items-center gap-2",children:[(0,x.jsx)(o.T,{className:"w-4 h-4"}),h===e.id?"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e!":"\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c"]})}),(0,x.jsx)("pre",{className:"bg-bg-primary p-4 rounded-md overflow-x-auto font-mono text-sm text-text-primary",children:r})]}):(0,x.jsx)("div",{className:"text-text-secondary",children:"\u041d\u0435\u0442 \u043e\u0442\u0432\u0435\u0442\u0430"})]}),b===e.id&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"fixed inset-0 z-[199] bg-black/50",onClick:()=>u(null)}),(0,x.jsx)("div",{className:"fixed top-4 right-4 z-[201]",children:(0,x.jsx)("button",{onClick:()=>u(null),className:"px-4 py-2 bg-accent-red text-white rounded-md text-sm font-semibold hover:bg-red-600 transition-colors shadow-lg",title:"\u0421\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u043f\u0435\u0441\u043e\u0447\u043d\u0438\u0446\u0443",children:"\u2715 \u0421\u0432\u0435\u0440\u043d\u0443\u0442\u044c"})})]})]}),i&&(0,x.jsxs)("div",{className:"p-4 bg-blue-500/10 dark:bg-blue-500/20 rounded-md border border-blue-500/30 mb-4",children:[(0,x.jsx)("strong",{className:"block mb-2 text-text-primary",children:"\u041f\u043e\u0434\u0441\u043a\u0430\u0437\u043a\u0430 (\u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430):"}),(0,x.jsx)("div",{className:r===e.correctAnswer?"text-green-600 dark:text-green-400 font-semibold":"text-red-600 dark:text-red-400 font-semibold",children:r===e.correctAnswer?"\u2713 \u041e\u0442\u0432\u0435\u0442 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439":"\u2717 \u041e\u0442\u0432\u0435\u0442 \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439. \u041f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442: ".concat(e.correctAnswer)}),(0,x.jsx)("p",{className:"text-xs text-text-secondary mt-2",children:"\u042d\u0442\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u0434\u0441\u043a\u0430\u0437\u043a\u0430. \u041e\u0446\u0435\u043d\u043a\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u043f\u0440\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0430 \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u043d\u0438\u0436\u0435."})]}),(0,x.jsx)("div",{className:"p-4 bg-bg-tertiary rounded-md",children:(0,x.jsxs)("label",{children:[(0,x.jsx)("strong",{className:"block mb-2 text-text-primary",children:"\u041e\u0446\u0435\u043d\u043a\u0430 (\u0431\u0430\u043b\u043b\u044b):"}),(0,x.jsxs)("div",{className:"flex gap-2 items-center mt-2",children:[(0,x.jsx)("input",{type:"number",value:null!==l&&void 0!==l?l:"",onChange:t=>m.setQuestionGrade(e.id,t.target.value),min:"0",max:a,className:"px-3 py-2 border border-border rounded-md bg-bg-primary text-text-primary font-inherit text-sm transition-all focus:outline-none focus:border-accent-blue focus:ring-2 focus:ring-accent-blue/15 w-[100px]"}),(0,x.jsxs)("span",{children:["/ ",a]}),(0,x.jsx)(n.A,{variant:"primary",size:"md",onClick:()=>m.saveGrade(e.id),disabled:null===l||void 0===l,children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})})]},e.id||t)})})]})}),(0,x.jsx)(i.NS,{cancelText:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onCancel:()=>m.cancel(),showCancel:!0})]}):null})},235:(e,t,s)=>{s.d(t,{aF:()=>l,NS:()=>n,cw:()=>i,rQ:()=>a});s(950);var r=s(414);const l=e=>{let{children:t,onOverlayClick:s,size:l="medium"}=e;return(0,r.jsx)("div",{className:"fixed inset-0 w-full h-full bg-black/50 flex items-center justify-center z-[9999] overflow-auto p-0 md:p-5",onClick:e=>{e.target===e.currentTarget&&s&&s(e)},children:(0,r.jsx)("div",{className:"bg-bg-primary border border-border shadow-[0_4px_20px_rgba(0,0,0,0.3)] relative z-[10000] mx-auto flex flex-col overflow-hidden w-full h-full max-w-full max-h-full rounded-none md:rounded-xl md:w-[90%] md:h-auto ".concat("large"===l?"md:max-w-[1000px] md:max-h-[800px]":"md:max-w-[600px] md:max-h-[600px]"),onClick:e=>e.stopPropagation(),children:t})})},a=e=>{let{children:t}=e;return(0,r.jsx)("div",{className:"p-4 border-b border-border flex-shrink-0",children:"string"===typeof t?(0,r.jsx)("h3",{className:"m-0 text-xl font-semibold text-text-primary",children:t}):t})},i=e=>{let{children:t}=e;return(0,r.jsx)("div",{className:"p-6 overflow-y-auto flex-1 min-h-0 bg-bg-secondary",children:t})};var d=s(652);const n=function(e){let{cancelText:t="\u041e\u0442\u043c\u0435\u043d\u0430",onCancel:s,okText:l="\u041e\u041a",onOk:a,okType:i="primary",showCancel:n=!0,showOk:c=!1,okDisabled:o=!1,disabled:x=!1}=e;return(0,r.jsxs)("div",{className:"px-4 py-2 border-t border-border flex gap-3 justify-end flex-shrink-0",children:[n&&s&&(0,r.jsx)(d.A,{variant:"secondary",size:"md",onClick:s,disabled:x,children:t}),(c||a)&&l&&(0,r.jsx)(d.A,{variant:"danger"===i?"danger":"primary",size:"md",onClick:a,disabled:x||o,children:l})]})}}}]);